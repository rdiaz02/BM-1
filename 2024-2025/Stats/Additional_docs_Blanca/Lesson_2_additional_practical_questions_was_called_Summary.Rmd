---
title: "Summary (example)"
output:
     bookdown::pdf_document2: default
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = FALSE)

library(car)
library(RcmdrMisc)
library(ggplot2)
library(knitr)
library(ggplot2)
library(gridExtra)
```

# Identifying an experimental design, comparing two groups

## Variables and experimental unit

```{r, echo = FALSE}
## RDU: I copy the table from the PDF, replace " " by ", " and import.
## df <- read.csv('C:/Users/BL.5060101/OneDrive - UAM/UAM/BM-2/exam/MRI.csv',  header = TRUE, sep = ";",)
## df[,5] <- NULL
## colnames(df) <- c("Subject.ID", "Group", "Protein.before","Protein.after")
## df.measures <- data.frame( "Measure" = rep(seq(1:2),10), df)

df.measures <- read.csv("data_example_additional.csv", header = TRUE)
kable(df.measures, align = "c")
```
## Think wether the following senteces are TRUE or FALSE
 (a) We have 10 independent measurements, each one with a corresponding replicate (Protein.before, Protein.after)
 (b) We have 40 independent measurements.
 (c) We have 1 numerical variable.


## Optimal representation of the data

Argue which of the following graphs are a better respresentation of the data

```{r, echo=FALSE, fig.align='center',fig.height = 5, fig.width=5}
df$Subject.ID<- factor(df$Subject.ID)

df.m <- aggregate(df[,c("Protein.before","Protein.after")],
                  by = list(ID = df$Subject.ID, Group = df$Group),
                  FUN = mean)

df.r <- reshape(df.m,
                varying = list(c("Protein.before", "Protein.after")),
                direction = "long",
                idvar = "ID",
                v.names = "Protein")

one <- ggplot(df.r, aes(factor(time), Protein)) +
  geom_boxplot() +
  facet_grid(~ Group) +
  ggtitle("Graph A") +
  labs(x ="Time points", y= "Protein (µm2/s)") +
  theme(plot.title = element_text(hjust = 0.5))

two <- ggplot(df.r, aes(factor(time), Protein)) +
  geom_point(size = 0.75) +
  facet_grid(~ Group) +
  ggtitle("Graph B") +
  labs(x ="Time points", y= "Protein (µm2/s)") +
  theme(plot.title = element_text(hjust = 0.5))

three <- ggplot(df.r, aes(factor(time), Protein)) +
  stat_summary(fun = mean, geom = "point") +
  stat_summary(fun.data = mean_se, geom = "errorbar",
               linetype = "dashed",
               linewidth = 0.5) +
  ggtitle("Graph C") +
  facet_grid(~ Group) +
  labs(x ="Time points", y= "Protein (µm2/s)") +
  theme(plot.title = element_text(hjust = 0.5))


four <- ggplot(df.r, aes(factor(time), Protein)) +
  stat_summary(fun = mean, geom = "bar", fill = "White", colour = "Black") +
  ggtitle("Graph D") +
  facet_grid(~ Group) +
  labs(x ="Time points", y= "Protein (µm2/s)") +
  theme(plot.title = element_text(hjust = 0.5))


grid.arrange(one,two,three,four,ncol=2)
#ggsave(file="Question1_1.png",g)
```
## Choosing between tests

Taking into account that you want to compare the values of protein expression before an experimental manipulation ("x") and after such manipulation ("y") to n = 10 subjects, choose which of the following tests you would apply:
```{r, echo = TRUE}
test1 <- t.test(x = df.m$Protein.before, y = df.m$Protein.after, paired = TRUE, var.equal = FALSE)
test1
test2 <- t.test(x = df.m$Protein.before, y = df.m$Protein.after, paired = FALSE, var.equal = TRUE)
test2
```
a) test1 because is paired
b) test2 because in not paired

## Interpretation of tests

From the previous outputs, we can deduce that:(Answer with TRUE or FALSE)
a) Difference between mean values can be considered significant because the 95% CI include 0
b) Because the p-value in test2 is higher than in test1, this indicates that the probability of   obtaining a significant difference between mean values is higher in test2
c) There is no sufficient statistical evidence to support that the means are different
